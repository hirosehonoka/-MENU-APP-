作成日：2025年10月23日
作成者：廣瀬萌花

※作成した機能には◯
|機能名|9/24|10/2|10/16|10/23|
|:--|:--|:--|:--|:--|
|サインアップ機能|◯|||
|ログイン機能|◯|||
|ログアウト機能|◯|||
|ユーザ情報更新機能|◯|||
|食材登録機能||||◯|※プロンプトへの埋め込みは成功
|献立作成依頼機能||API出力完成、ソルバー途中|ソルバー利用・以前の献立削除完成・献立作成未完|ソルバー利用未完|
|献立一覧閲覧機能|◯|||
|食材一覧閲覧機能|◯|||
|栄養素量閲覧機能||||

## 献立作成機能詳細
### 10/16
- ソルバーは通りMenuテーブルに格納できたが、中身がnullだった。←制約条件が厳しかった？
- 考慮する栄養素をカロリー、タンパク質、脂質、炭水化物、食塩に絞ってみるが、15分以上経ってもページ遷移なし←ソルバーでの計算に時間がかかっている。条件が少なすぎて解が多いことが原因？
- 食物繊維とカルシウムを追加したが、画面遷移しない→構文エラー ファイル "/Users/hiruse/Desktop/menu-app/source/main/menuapp.py"、行377？^ SyntaxError: 無効な文字 '？' (U+FF1F)　※原田さんに相談中→解決

### 10/23
- 考慮する栄養素をカロリー、タンパク質、脂質、炭水化物、食塩、食物繊維、カルシウムにしたが、ソルバーの計算に10分以上かかっている
- ビタミンAを追加したが、ソルバーの計算に10分以上かかっている
- ビタミンDを追加したが、ソルバーの計算に10分以上かかっている
- ビタミンCを追加したが、ソルバーの計算に10分以上かかっている
- ビタミンB1,B2を追加したが、ソルバーの計算に10分以上かかっている
- 鉄を追加して全ての栄養素を考慮したが、ソルバーの計算に10分以上かかっている
　→ソルバーの計算が終わらないのは条件が少ないからではない？
 - 前回全ての栄養素量を考慮した時にnullだったのは栄養目標データの栄養素名とレシピ栄養データの栄養素名が違かったから？
 - pyomoのCBCには料理数が多すぎるらしい？
- ソルバー使用時間(5分以内)と最適性誤差(2%)による終了を設定
- １回目結果

||カロリー|たんぱく質|脂質|炭水化物|ビタミンA|ビタミンB1|ビタミンB2|ビタミンC|カルシウム|鉄|食塩|食物繊維|ビタミンD|
|:--|:--|:--|:--|:--|:--|:--|:--|:--|:--|:--|:--|:--|:--|
|目標量|4914~6006|177~273|121~182|682~887|1820~7560|2.24~|3.36~|280~|1820~7000|16.8~|~18.2|50.4~|25.2~280|
|結果|5630.5|293.9|229.4|666.6|3753.5|3.783|5.682|887.5|2782.3|54.71|2782.3|54.71|47.83|89.05|42.92|

- カロリー・ビタミン類・カルシウム・鉄・食物繊維OK
- たんぱく質・脂質・食塩が過剰、炭水化物が不足
- PFCバランスはたんぱく質約21%、脂質約37%、炭水化物約47%でたんぱく質が少し過剰、脂質が大幅に過剰、炭水化物が不足
- 使用する食材は４３種類
- ２回目結果：同じ献立が作成された

### 10/30
- 必ず使用する食材を考慮するとAPI出力されたモデルが今までのものと全く違うものになる
- 毎回もしくはユーザごとで異なるのはユーザ情報と登録する食材のみ→毎回異なるのはパラメータのみ
- API出力コードは同じものを使い回し、ユーザ情報と登録する食材の部分のパラメータを更新しても問題ないようにする
- API出力コードが固定ならAPIなしの生成AIで出力しても良いのでは？

### 11/11
- 制約条件の矛盾により解なしになった→ソルバーにかけること自体はできた

### 11/13
- 制約条件をカロリーのみにして試してみた。→解が出た
- たんぱく質、脂質、炭水化物を足した→解が出た
- 献立の主食、主菜、副菜、汁物の数に関する制約を足した→解が出た
- 登録された食材に関する制約を足した→登録する食材による　例）ご飯100g→◯、春雨50g→解なし
- 必ず使い切るのではなくできる限り使い切るという制約に変更し、目的関数に余った食材の量の最小化→解が出るが登録した食材が使われないことがある
- 目的関数で余った食材の量に関するペナルティなどを追加→登録した食材が使われる頻度が増えた→とりあえずこれで
- itemweightに格納されている食材の使用量を格納されている値の倍数にする制約を追加する（※満たせない場合が頻発する可能性あり）
- 誤差変数を導入することで制約条件の優先順位を低くしつつ、満たせなくても解なしにならないようにする
- ここまでで特に主食が白米以外での被りが多いため、料理の使用回数の制約条件の優先度は上げて良いかも
- 食塩以外の栄養素を考慮→解あり
- 食塩を追加→解なし
